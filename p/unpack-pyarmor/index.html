<!DOCTYPE html>
<html lang="es" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='Desempaquetado de un Archivo &#34;.py&#34; ofuscado con Pyarmor v8.'>
<title>Unpack Pyarmor &amp; Pyinstaller</title>

<link rel='canonical' href='https://sx1v4n.github.io/p/unpack-pyarmor/'>

<link rel="stylesheet" href="/scss/style.min.8191399262444ab68b72a18c97392f5349be20a1615d77445be51e974c144cff.css"><meta property='og:title' content='Unpack Pyarmor &amp; Pyinstaller'>
<meta property='og:description' content='Desempaquetado de un Archivo &#34;.py&#34; ofuscado con Pyarmor v8.'>
<meta property='og:url' content='https://sx1v4n.github.io/p/unpack-pyarmor/'>
<meta property='og:site_name' content='S.x1v4n'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:published_time' content='2023-04-16T00:00:00&#43;00:00'/><meta property='article:modified_time' content='2023-04-16T00:00:00&#43;00:00'/><meta property='og:image' content='https://sx1v4n.github.io/p/unpack-pyarmor/logo.png' />
<meta name="twitter:title" content="Unpack Pyarmor &amp; Pyinstaller">
<meta name="twitter:description" content="Desempaquetado de un Archivo &#34;.py&#34; ofuscado con Pyarmor v8."><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://sx1v4n.github.io/p/unpack-pyarmor/logo.png' />
    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "dark");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/logo_hude82ea7f464a850aa72eb63e992f12f3_89784_300x0_resize_q75_box.jpg" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">S.x1v4n</a></h1>
            <h2 class="site-description">Jr Penetration Tester / eJPTv2</h2>
        </div>
    </header><ol class="social-menu">
            
                <li>
                    <a 
                        href='https://github.com/Sx1v4n'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <?xml version="1.0"?><svg fill="#FFFFFF" xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 50 50" width="50px" height="50px">    <path d="M17.791,46.836C18.502,46.53,19,45.823,19,45v-5.4c0-0.197,0.016-0.402,0.041-0.61C19.027,38.994,19.014,38.997,19,39 c0,0-3,0-3.6,0c-1.5,0-2.8-0.6-3.4-1.8c-0.7-1.3-1-3.5-2.8-4.7C8.9,32.3,9.1,32,9.7,32c0.6,0.1,1.9,0.9,2.7,2c0.9,1.1,1.8,2,3.4,2 c2.487,0,3.82-0.125,4.622-0.555C21.356,34.056,22.649,33,24,33v-0.025c-5.668-0.182-9.289-2.066-10.975-4.975 c-3.665,0.042-6.856,0.405-8.677,0.707c-0.058-0.327-0.108-0.656-0.151-0.987c1.797-0.296,4.843-0.647,8.345-0.714 c-0.112-0.276-0.209-0.559-0.291-0.849c-3.511-0.178-6.541-0.039-8.187,0.097c-0.02-0.332-0.047-0.663-0.051-0.999 c1.649-0.135,4.597-0.27,8.018-0.111c-0.079-0.5-0.13-1.011-0.13-1.543c0-1.7,0.6-3.5,1.7-5c-0.5-1.7-1.2-5.3,0.2-6.6 c2.7,0,4.6,1.3,5.5,2.1C21,13.4,22.9,13,25,13s4,0.4,5.6,1.1c0.9-0.8,2.8-2.1,5.5-2.1c1.5,1.4,0.7,5,0.2,6.6c1.1,1.5,1.7,3.2,1.6,5 c0,0.484-0.045,0.951-0.11,1.409c3.499-0.172,6.527-0.034,8.204,0.102c-0.002,0.337-0.033,0.666-0.051,0.999 c-1.671-0.138-4.775-0.28-8.359-0.089c-0.089,0.336-0.197,0.663-0.325,0.98c3.546,0.046,6.665,0.389,8.548,0.689 c-0.043,0.332-0.093,0.661-0.151,0.987c-1.912-0.306-5.171-0.664-8.879-0.682C35.112,30.873,31.557,32.75,26,32.969V33 c2.6,0,5,3.9,5,6.6V45c0,0.823,0.498,1.53,1.209,1.836C41.37,43.804,48,35.164,48,25C48,12.318,37.683,2,25,2S2,12.318,2,25 C2,35.164,8.63,43.804,17.791,46.836z"/></svg>
                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://www.linkedin.com/in/ivan-romero-capita-a56838256/'
                        target="_blank"
                        title="Linkedin"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 48 48" width="48px" height="48px"><path fill="#0288D1" d="M42,37c0,2.762-2.238,5-5,5H11c-2.761,0-5-2.238-5-5V11c0-2.762,2.239-5,5-5h26c2.762,0,5,2.238,5,5V37z"/><path fill="#FFF" d="M12 19H17V36H12zM14.485 17h-.028C12.965 17 12 15.888 12 14.499 12 13.08 12.995 12 14.514 12c1.521 0 2.458 1.08 2.486 2.499C17 15.887 16.035 17 14.485 17zM36 36h-5v-9.099c0-2.198-1.225-3.698-3.192-3.698-1.501 0-2.313 1.012-2.707 1.99C24.957 25.543 25 26.511 25 27v9h-5V19h5v2.616C25.721 20.5 26.85 19 29.738 19c3.578 0 6.261 2.25 6.261 7.274L36 36 36 36z"/></svg>
                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        

        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>Inicio</span>
            </a>
        </li>
        
        

        <li >
            <a href='/writeups/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="ionicon" viewBox="0 0 512 512"><path d="M336 64h32a48 48 0 0148 48v320a48 48 0 01-48 48H144a48 48 0 01-48-48V112a48 48 0 0148-48h32" fill="none" stroke="currentColor" stroke-linejoin="round" stroke-width="32"/><rect x="176" y="32" width="160" height="64" rx="26.13" ry="26.13" fill="none" stroke="currentColor" stroke-linejoin="round" stroke-width="32"/></svg>
                
                <span>WriteUps</span>
            </a>
        </li>
        
        

        <li >
            <a href='/whoami/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="ionicon" viewBox="0 0 512 512"><path d="M344 144c-3.92 52.87-44 96-88 96s-84.15-43.12-88-96c-4-55 35-96 88-96s92 42 88 96z" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"/><path d="M256 304c-87 0-175.3 48-191.64 138.6C62.39 453.52 68.57 464 80 464h352c11.44 0 17.62-10.48 15.65-21.4C431.3 352 343 304 256 304z" fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="32"/></svg>
                
                <span>Whoami</span>
            </a>
        </li>
        
        

        <li >
            <a href='/archivos/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Archivo</span>
            </a>
        </li>
        
        

        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        

        <div class="menu-bottom-section">
            
            
                <li id="dark-mode-toggle">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <span>Dark Mode</span>
                </li>
            
        </div>
    </ol>
</aside>

    

            <main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/p/unpack-pyarmor/">
                <img src="/p/unpack-pyarmor/logo.png"
                        
                        width="1000" 
                        height="667" 
                        loading="lazy"
                        alt="Featured image of post Unpack Pyarmor &amp; Pyinstaller" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/unpacking/" style="background-color: #2e92e6; color: #ff;">
                Unpacking
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/unpack-pyarmor/">Unpack Pyarmor &amp; Pyinstaller</a>
        </h2>
    
        
        <h3 class="article-subtitle">
            Desempaquetado de un Archivo &#34;.py&#34; ofuscado con Pyarmor v8.
        </h3>
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Apr 16, 2023</time>
            </div>
        

        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <p>Comenzamos mirando que tipo de obfuscación lleva el archivo.</p>
<p><img src="/p/unpack-pyarmor/1.png"
	width="831"
	height="361"
	srcset="/p/unpack-pyarmor/1_hud8f40f2c6970da35233ab78f9b92ce46_21353_480x0_resize_box_3.png 480w, /p/unpack-pyarmor/1_hud8f40f2c6970da35233ab78f9b92ce46_21353_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="230"
		data-flex-basis="552px"
	
></p>
<p>Utilizamos la herramienta pyinstxtractor.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python pyinstxtractor.py natif.exe
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Processing natif.exe
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Pyinstaller version: 2.1+
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Python version: 3.10
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Length of package: <span class="m">873288</span> bytes
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Found <span class="m">9</span> files in CArchive
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Beginning extraction...please standby
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Possible entry point: pyiboot01_bootstrap.pyc
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Possible entry point: pyi_rth_inspect.pyc
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Possible entry point: natif.pyc
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Found <span class="m">97</span> files in PYZ archive
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Successfully extracted pyinstaller archive: natif.exe
</span></span></code></pre></td></tr></table>
</div>
</div><p>Obtenemos una carpeta llamada &ldquo;natif.exe_extracted&rdquo;, podemos ver que tenemos un archivo .pyc que está compilado.</p>
<p><img src="/p/unpack-pyarmor/2.png"
	width="1283"
	height="256"
	srcset="/p/unpack-pyarmor/2_hu45db24c07f6f504e36e56e3ec7f7d56b_41826_480x0_resize_box_3.png 480w, /p/unpack-pyarmor/2_hu45db24c07f6f504e36e56e3ec7f7d56b_41826_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="501"
		data-flex-basis="1202px"
	
></p>
<p>Usaremos la herramienta pydc, Adjunto el repositorio y su instalación.</p>
<p>Repositorio:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">https://github.com/zrax/pycdc
</span></span></code></pre></td></tr></table>
</div>
</div><p>Instalación:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">cd</span> pycdc
</span></span><span class="line"><span class="cl">cmake .
</span></span><span class="line"><span class="cl">make
</span></span><span class="line"><span class="cl">make check
</span></span></code></pre></td></tr></table>
</div>
</div><p>Procedemos con su uso.
Ya ha sido eliminada la obfuscación de pyinstaller, solo quedaría eliminar la de pyarmor.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">./pycdc natif.pyc &gt; natif.py 
</span></span></code></pre></td></tr></table>
</div>
</div><p>Veamos como eliminamos esta protección.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">cat natif.py                                                                                                                                 
</span></span><span class="line"><span class="cl">───────┬─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
</span></span><span class="line"><span class="cl">       │ File: natif.py
</span></span><span class="line"><span class="cl">───────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
</span></span><span class="line"><span class="cl">   <span class="m">1</span>   │ <span class="c1"># Source Generated with Decompyle++</span>
</span></span><span class="line"><span class="cl">   <span class="m">2</span>   │ <span class="c1"># File: natif.pyc (Python 3.10)</span>
</span></span><span class="line"><span class="cl">   <span class="m">3</span>   │ 
</span></span><span class="line"><span class="cl">   <span class="m">4</span>   │ from pyarmor_runtime_000000 import __pyarmor__
</span></span><span class="line"><span class="cl">   <span class="m">5</span>   │ __pyarmor__<span class="o">(</span>__name__, __file__, b<span class="s1">&#39;PY000000\x00\x03\x0b\x00\xa7\r\r\n\x80\x00\x01\x00\x08\x00\x00\x00\x04\x00\x00\x00@\x00\x00\x00\xde\x02\x00\x00\x12\t\x04\x00\xe8\
</span></span></span><span class="line"><span class="cl"><span class="s1">       │ x12\x1be\xac73Z\x03\xaf\x19\xa3\xae\x9f\xa4z\x00\x00\x00\x00\x00\x00\x00\x00F\x97Ea\xcc\xa8 \x7f\x82g6\&#39;</span><span class="se">\x</span>d1<span class="se">\x</span>8dB<span class="o">=</span>J<span class="se">\x</span>08?<span class="se">\x</span>e8/<span class="se">\x</span>dc<span class="se">\x</span>0b<span class="se">\x</span>10<span class="se">\x</span>b1<span class="se">\x</span>9f<span class="se">\x</span>9d<span class="se">\x</span>f4<span class="se">\x</span>f2j8<span class="se">\x</span>beb
</span></span><span class="line"><span class="cl">       │ <span class="se">\x</span>da<span class="se">\x</span>84<span class="se">\x</span>c7kE<span class="se">\x</span>ed*J<span class="se">\x</span>08+<span class="se">\x</span>b4f<span class="se">\x</span>a4<span class="se">\x</span>7fU<span class="se">\x</span>db<span class="p">|</span>Z<span class="se">\x</span>bb?7f<span class="se">\x</span>d8<span class="se">\x</span>c5<span class="se">\x</span>d5<span class="se">\x</span>b6z9<span class="se">\x</span>f5<span class="se">\x</span>abq<span class="se">\x</span>83<span class="se">\x</span>be<span class="se">\x</span>d1Wn<span class="se">\x</span>16<span class="se">\x</span>05<span class="se">\x</span>19<span class="se">\x</span>db<span class="se">\x</span>bb<span class="se">\x</span>ed<span class="se">\x</span>a3<span class="se">\x</span>cd@2<span class="se">\x</span>ce<span class="se">\x</span>f5<span class="se">\x</span>fa<span class="se">\x</span>capS<span class="sb">`</span>u<span class="se">\x</span>fe<span class="se">\x</span>d5<span class="se">\x</span>08cb<span class="se">\x</span>c
</span></span><span class="line"><span class="cl">       │ 7a<span class="se">\x</span>a2<span class="se">\x</span>01<span class="se">\x</span>f7<span class="se">\x</span>99<span class="se">\x</span>80<span class="se">\x</span>8a<span class="o">{</span><span class="se">\x</span>e50<span class="se">\x</span>df<span class="se">\x</span>9c<span class="se">\x</span>b7<span class="se">\x</span>10<span class="o">[</span>:Yj<span class="p">&amp;</span>_<span class="se">\x</span>08<span class="p">|</span><span class="se">\x</span>86<span class="se">\x</span>bf<span class="se">\x</span>0b<span class="o">]</span>G<span class="se">\x</span>f0KD<span class="se">\x</span>a8<span class="se">\x</span>d8/,<span class="se">\x</span>10,<span class="se">\x</span>a8M<span class="se">\x</span>fb<span class="se">\x</span>d3<span class="se">\x</span>9a9<span class="se">\x</span>d3<span class="se">\x</span>b1<span class="se">\x</span>ce<span class="se">\x</span>ca<span class="se">\x</span>91!h<span class="se">\r\x</span>00<span class="se">\x</span>98<span class="se">\x</span>e9$<span class="se">\x</span>89<span class="se">\x</span>fe<span class="se">\x</span>dd<span class="se">\x</span><span class="m">1</span>
</span></span><span class="line"><span class="cl">       │ b<span class="se">\x</span>85b<span class="se">\x</span>9e<span class="se">\x</span>b7<span class="se">\x</span>b4<span class="se">\x</span>e9<span class="se">\x</span>ee%<span class="se">\x</span>cf<span class="se">\x</span>95<span class="se">\x</span>a9<span class="se">\x</span>89+<span class="s2">&#34;}\xdc\xd7\xa6u1\x189\x1c\xbb\xe1\x8e\x1b\xbd\xa6T\xfb\xc8\x03\xd2\x86Z\x1f\x8f\x8e:\xe3\xdcQ\x19\xca\xbf)\xbb\xee\x82O\
</span></span></span><span class="line"><span class="cl"><span class="s2">       │ x84\x90a\xaf\x93\xf8\xd2\x1e\x1f\xc1\xa5\x1cN\x8b\xbd\xfa\x01\x977E\xe2\rJt\x12@\x8f\xc1\xe2\x16l\xcc\x91R\xb4\x04]\xc6\xd0\x0e\x18\x8ak&#34;</span>Y3<span class="se">\x</span>07<span class="p">|</span><span class="se">\x</span>fb<span class="se">\x</span>f5$<span class="se">\x</span>da<span class="se">\x</span>05<span class="se">\x</span>b
</span></span><span class="line"><span class="cl">       │ 9<span class="se">\x</span>80h+<span class="se">\x</span>fei<span class="se">\x</span>f6<span class="se">\x</span>80<span class="se">\x</span>cb<span class="se">\x</span>e9<span class="se">\x</span>866<span class="se">\x</span>1f<span class="se">\x</span>98l<span class="se">\x</span>f8<span class="se">\x</span>88<span class="se">\x</span>e8<span class="se">\x</span>81u<span class="se">\x</span>9e<span class="se">\x</span>be<span class="se">\x</span>f91<span class="o">]</span>D<span class="se">\x</span>ec<span class="se">\x</span>e2<span class="se">\x</span>ba<span class="se">\x</span>ba<span class="se">\x</span>eb<span class="se">\x</span>d1<span class="se">\x</span>fcqV<span class="p">&amp;</span>~G~<span class="se">\x</span>c0<span class="se">\x</span>98a<span class="se">\x</span>dc<span class="se">\x</span>aaN&gt;<span class="se">\x</span>1aK<span class="se">\x</span>b86<span class="se">\x</span>1fT<span class="se">\x</span>dc<span class="se">\x</span>f2e<span class="se">\x</span>9e<span class="se">\x</span>1e<span class="se">\x</span>15<span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>       │ r<span class="se">\x</span>ecc<span class="se">\x</span>c7o<span class="se">\x</span>b7<span class="se">\x</span>bc<span class="se">\x</span>86<span class="se">\x</span>13iM<span class="se">\x</span>15<span class="p">;</span><span class="se">\x</span>a4<span class="se">\x</span>ed?<span class="se">\x</span>80<span class="p">&amp;</span>8p<span class="se">\x</span>81<span class="se">\x</span>1c<span class="se">\x</span>f3G<span class="o">)</span><span class="se">\x</span>e2<span class="se">\x</span>fd<span class="se">\x</span>82<span class="sb">`</span>Y<span class="se">\x</span>84<span class="se">\x</span>fdW<span class="se">\x</span>11<span class="s2">&#34;R\xb2C\xd8\x17\xcc\xfc\xda6\xcf\xe4\x0b\x16\xdf\x0e\xe7F\x04\x1bsD&amp;Q\x93
</span></span></span><span class="line"><span class="cl"><span class="s2">       │ \x07\x1d8L\x7f\t.\x8b\x87C\xce\x15e\xa6TMZ\x8d\xa0\xf9\xcbl\xf8\xa8\xa0\xcb\x1fs\x9cP\xff\xcb\xd7)\x94\x19\xa3%\x89\x9c\xd8\x13\xac\xda@\x10}\xa8\xf9[\x17_\xe5\xe8\
</span></span></span><span class="line"><span class="cl"><span class="s2">       │ x9b\x8bJ\x0e\x06y\xac4A\xc65*N\x80\xa2U\xed\x8c\xf7\x04R`\xad7\xc2J\xe8\xefv\xfd\xe3\xd6^\x9e\xd5\xdcW\xe9Q7\xa7\xf4\xc8\xc7\xa5\xb7\xfd\x9fhE\x8b \x1dFz\t\x9d\xfe\
</span></span></span><span class="line"><span class="cl"><span class="s2">       │ xb2j\xef\xca%\xe2\xe0\x85+eF\xafL\x1c\xee\x0c\xeal\r\x99\x04d\\\xc7\xe6\xa9\xbc\xefT\x9a\xdb\xe9De\x00\xc9%\t\x08\x82\xe4\x86\xfb\xe2\xf9:\x12\xa4\xe2\xff\xb6\x93\x
</span></span></span><span class="line"><span class="cl"><span class="s2">       │ dc\x15\x1c\xc6c\x15\x97\x0b\xe5\xe2\xe9\xac:Ns\\xg\xc4B,\x94\xc3{:\xcd\xcf;q\x9f\x86\xdfM\x08U\x9dLY}\xcerH1\x9e\x0b\xc5A\xad\xc1r)\xdc\xbf\xb2Og.\x0b\xea\xfd\xc5\x
</span></span></span><span class="line"><span class="cl"><span class="s2">       │ b6</span><span class="nv">$Ez</span><span class="s2">\x1a\x1d}w\x99\x1d\xb4\xec3\x0c\r]t\xc4\xde/\x11\x9c\xbf*\x01\x1b\x14\xc2p:k\xc2\x168\xa6</span>$<span class="s2">\x85?Q[x\x8b\xccX\xe3H\xa7\xd1\xd7\xf0)\\n_w\x06X\x049\x92\x06\xee]&gt;\
</span></span></span><span class="line"><span class="cl"><span class="s2">       │ x07\x1f&lt;\x8f\x0b\x9f\x1br\xfc\xbcQ\x0c\xefc\x8b\xe5\xae\xd3\xe6u\xd5#\xc7\x13\x98\x17\x97|y\xc8\xb2\xfe\xd7osUzT\xbf\x87\xcb\xebe\xcd\x89\x04[\xc5\xb7mA0e\xbf\xe8=\
</span></span></span><span class="line"><span class="cl"><span class="s2">       │ xfe\xfc\xb6O\xc6\x7fq\x9d\xbd\xb1\x9e\xc4#\xe4\\\xb1\x83&#39;)
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Vamos a realizar un volcado de archivos con tal de obtener las credenciales.</p>
<p>Utilizaremos un script llamado memdump.py</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">#! /usr/bin/env python3
</span></span><span class="line"><span class="cl">import sys
</span></span><span class="line"><span class="cl">import re
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">if __name__ == &#34;__main__&#34;:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    if len(sys.argv) != 2:
</span></span><span class="line"><span class="cl">        print(&#39;Usage:&#39;, sys.argv[0], &#39;&lt;process PID&gt;&#39;, file=sys.stderr)
</span></span><span class="line"><span class="cl">        exit(1)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    pid = sys.argv[1]
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    # maps contains the mapping of memory of a specific project
</span></span><span class="line"><span class="cl">    map_file = f&#34;/proc/{pid}/maps&#34;
</span></span><span class="line"><span class="cl">    mem_file = f&#34;/proc/{pid}/mem&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    # output file
</span></span><span class="line"><span class="cl">    out_file = f&#39;{pid}.dump&#39;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    # iterate over regions
</span></span><span class="line"><span class="cl">    with open(map_file, &#39;r&#39;) as map_f, open(mem_file, &#39;rb&#39;, 0) as mem_f, open(out_file, &#39;wb&#39;) as out_f:
</span></span><span class="line"><span class="cl">        for line in map_f.readlines():  # for each mapped region
</span></span><span class="line"><span class="cl">            m = re.match(r&#39;([0-9A-Fa-f]+)-([0-9A-Fa-f]+) ([-r])&#39;, line)
</span></span><span class="line"><span class="cl">            if m.group(3) == &#39;r&#39;:  # readable region
</span></span><span class="line"><span class="cl">                start = int(m.group(1), 16)
</span></span><span class="line"><span class="cl">                end = int(m.group(2), 16)
</span></span><span class="line"><span class="cl">                mem_f.seek(start)  # seek to region start
</span></span><span class="line"><span class="cl">                print(hex(start), &#39;-&#39;, hex(end))
</span></span><span class="line"><span class="cl">                try:
</span></span><span class="line"><span class="cl">                    chunk = mem_f.read(end - start)  # read region contents
</span></span><span class="line"><span class="cl">                    out_f.write(chunk)  # dump contents to standard output
</span></span><span class="line"><span class="cl">                except OSError:
</span></span><span class="line"><span class="cl">                    print(hex(start), &#39;-&#39;, hex(end), &#39;[error,skipped]&#39;, file=sys.stderr)
</span></span><span class="line"><span class="cl">                    continue
</span></span><span class="line"><span class="cl">    print(f&#39;Memory dump saved to {out_file}&#39;)
</span></span></code></pre></td></tr></table>
</div>
</div><p>Iniciamos el proceso y lo dejamos ejecutando.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python3 natif.py 
</span></span></code></pre></td></tr></table>
</div>
</div><p>Mientras tanto veremos lo procesos.
Es muy importante poner ese parámetro para poder ver los procesos padres y los hijos, nos fijamos en el segundo que es el PID.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ps -axjf
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/unpack-pyarmor/3.png"
	width="1381"
	height="257"
	srcset="/p/unpack-pyarmor/3_hu071cb9289a4ea4eef2e8e3800f95ef79_102700_480x0_resize_box_3.png 480w, /p/unpack-pyarmor/3_hu071cb9289a4ea4eef2e8e3800f95ef79_102700_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="537"
		data-flex-basis="1289px"
	
></p>
<p>Ahora vamos a realizar el volcado.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python3 memdump.py &lt;Number_PID&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>Debemos utilizar strings para poder extraer los datos legibles.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">strings &lt;proceso.dump&gt; &gt; &lt;proceso_legible.dump&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/unpack-pyarmor/4.png"
	width="936"
	height="417"
	srcset="/p/unpack-pyarmor/4_hu20f36ee21e53fcd6bad520d5da25b612_88032_480x0_resize_box_3.png 480w, /p/unpack-pyarmor/4_hu20f36ee21e53fcd6bad520d5da25b612_88032_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="224"
		data-flex-basis="538px"
	
>
<img src="/p/unpack-pyarmor/5.png"
	width="1287"
	height="287"
	srcset="/p/unpack-pyarmor/5_hub5f4403df652e3854707c2599073b4ab_39580_480x0_resize_box_3.png 480w, /p/unpack-pyarmor/5_hub5f4403df652e3854707c2599073b4ab_39580_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="448"
		data-flex-basis="1076px"
	
></p>
<p>Resultado:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python3 natif.py                                                                                                                             
</span></span><span class="line"><span class="cl">User: NatifLoop
</span></span><span class="line"><span class="cl">Password: Py4RmOrDeObfSCati0n
</span></span><span class="line"><span class="cl">Great!
</span></span></code></pre></td></tr></table>
</div>
</div>
</section>


    <footer class="article-footer">
    

    </footer>


    
</article>

    

    

     
    
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2020 - 
        
        2023 S.x1v4n
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.16.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
